<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.5.xsd
        http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">

    <changeSet id='create-user_games_table' author="langelihle" context="localhost">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="user_games"/>
            </not>
        </preConditions>
        <sql>
            CREATE TABLE user_games
            (
                user_game_id INT PRIMARY KEY,
                user_id      INT,
                game_id      INT,
                user_points  INT,
                FOREIGN KEY (user_id) REFERENCES Users (user_id),
                FOREIGN KEY (game_id) REFERENCES Games (game_id)
            );
        </sql>
    </changeSet>

    <changeSet id='create-user_games-sequence' author="langelihle" context="localhost">
        <preConditions onFail="MARK_RAN">
            <tableExists tableName="user_games"/>
        </preConditions>
        <sql>
            CREATE SEQUENCE user_games_id_seq;
        </sql>
    </changeSet>

    <changeSet id='set-user_games-sequence' author="langelihle" context="localhost">
        <preConditions onFail="MARK_RAN">
            <tableExists tableName="user_games"/>
        </preConditions>
        <sql>
            ALTER TABLE user_games ALTER COLUMN user_game_id SET DEFAULT nextval('user_games_id_seq');
        </sql>
    </changeSet>

</databaseChangeLog>